<html>
	<head>
		<title>Chunker</title>
		<link rel="shortcut icon" href="/static/icon.ico" type="image/x-icon">
	</head>
	<body>

		<pre id="state"></pre>

		<form action="/api/quit">
			<br><input type="submit" value="Shut Down">
		</form>

		<form action="/api/state">
			<br><input type="submit" value="View State">
		</form>

		<form action="/api/create">
			<input type="text" name="directory" placeholder="Source directory">
			<input type="text" name="chunkfile" placeholder=".chunker filename">
			<input type="text" name="name" placeholder="Name (Optional)">
			<input type="text" name="key" placeholder="Key (Optional)">
			<br><input type="submit" value="Create">
		</form>

		<form action="/api/add">
			<input type="hidden" name="type" value="static">
			<input type="text" name="chunkfile" placeholder=".chunker filename">
			<input type="text" name="directory" placeholder="Target directory">
			<br><input type="submit" value="Add Static">
		</form>

		<form action="/api/add">
			<input type="hidden" name="type" value="share">
			<input type="text" name="uuid" placeholder="UUID">
			<input type="text" name="directory" placeholder="Source directory">
			<br><input type="submit" value="Add Share">
		</form>

		<form action="/api/fetch">
			<input type="submit" value="Fetch Active Repos">
		</form>

		<script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
		<script>
if (!String.prototype.format) {
  String.prototype.format = function() {
    var args = arguments;
    return this.replace(/{(\d+)}/g, function(match, number) {
      return typeof args[number] != 'undefined'
        ? args[number]
        : match
      ;
    });
  };
}
		$.ajax({
			"dataType": "json",
			"url": "/api/state.json"
		}).done(function(data) {
			var text = "<table>";
			$.each(data.repos, function(i, repo) {
				text = text + "<tr>" +
				"<td>{0} ({1})<br><small>{2}</small><br><small>{3}</small></td>".format(repo.name, repo.type, repo.root, repo.uuid) +
				"<td><a href='/api/remove'>Remove</a></td>" +
				"</tr>";
			});
			text = text + "</table>";
			$("#state").html(text);
		});
		</script>
	</body>
</html>
